#!/bin/env -S lash run

set -euo pipefail

cd ../..

let INPUT_ROOT = "./target/release"
let OUTPUT_DIR = "./dist"

mkdir -p "$OUTPUT_DIR"
cd "$INPUT_ROOT"

let packed = 0
for dir in ./*
    let archive = "../../dist/" + dir + ".tar.gz"

    echo "Packing:" $dir "->" $archive
    tar -czf "$archive" "$dir"
    $packed++
end

if packed == 0
    echo "No directories found under ./target/release"
else
    echo $"Packed {packed} directories."
end
